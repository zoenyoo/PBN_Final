data=dat %>% st_drop_geometry(),
family="binomial" (link="logit"))
data.frame(100 * (exp(coef(hinMod1))-1)) %>%
kable()
data.frame((exp(coef(hinMod1)))) %>%
kable()
hinMod1 <- glm(hin ~ pop + PCT_f + PCT_asn + PCT_hsp + PCT_oth+ PCT_car + PCT_trn + PCT_bik + PCT_wfh + PCT_chld + PCT_own + all311 + m311,
data=dat %>% st_drop_geometry(),
family="binomial" (link="logit"))
data.frame((exp(coef(hinMod1)))) %>%
kable()
data.frame(100*(exp(coef(hinMod1)))) %>%
kable()
data.frame((100 * exp(coef(hinMod1)))) %>%
kable()
options(scipen=0)
data.frame((exp(coef(hinMod1)))) %>%
kable()
data.frame(100*(exp(coef(hinMod1)))) %>%
kable()
data.frame(100*(exp(coef(hinMod1)))-1) %>%
kable()
hinMod1 <- glm(hin ~ pop + mdn_inc + PCT_f + PCT_asn + PCT_hsp + PCT_oth+ PCT_car + PCT_trn + PCT_bik + PCT_wfh + PCT_chld + PCT_own + all311 + m311,
data=dat %>% st_drop_geometry(),
family="binomial" (link="logit"))
data.frame(100*(exp(coef(hinMod1)))-1) %>%
kable()
summary(hinMod1)
data.frame(100*(exp(coef(hinMod1)))-1) %>%
kable()
hinMod1 <- glm(hin ~ pop + mdn_inc + PCT_f + PCT_asn + PCT_hsp + PCT_car + PCT_trn + PCT_bik + PCT_wfh + PCT_chld + PCT_own + all311 + m311,
data=dat %>% st_drop_geometry(),
family="binomial" (link="logit"))
data.frame(100*(exp(coef(hinMod1)))-1) %>%
kable()
hinMod1 <- glm(hin ~ pop + mdn_inc + PCT_f + PCT_wht + PCT_blk + PCT_asn + PCT_hsp + PCT_car + PCT_trn + PCT_bik + PCT_wfh + PCT_chld + PCT_own + all311 + m311,
data=dat %>% st_drop_geometry(),
family="binomial" (link="logit"))
data.frame(100*(exp(coef(hinMod1)))-1) %>%
kable()
summary(hinMod1)
hinMod1 <- glm(hin ~ pop + mdn_inc + PCT_f + PCT_wht + PCT_blk + PCT_car + PCT_trn + PCT_bik + PCT_wfh + PCT_chld + PCT_own + all311 + m311,
data=dat %>% st_drop_geometry(),
family="binomial" (link="logit"))
summary(hinMod1)
hinMod1 <- glm(hin ~ pop + PCT_f + PCT_wht + PCT_blk + PCT_car + PCT_trn + PCT_bik + PCT_wfh + PCT_chld + PCT_own + all311 + m311,
data=dat %>% st_drop_geometry(),
family="binomial" (link="logit"))
summary(hinMod1)
data.frame(100*(exp(coef(hinMod1)))-1) %>%
kable()
hinMod1 <- glm(hin ~ pop + PCT_wht + PCT_blk + PCT_car + PCT_trn + PCT_bik + PCT_wfh + PCT_chld + PCT_own + all311 + m311,
data=dat %>% st_drop_geometry(),
family="binomial" (link="logit"))
data.frame(100*(exp(coef(hinMod1)))-1) %>%
kable()
summary(hinMod1)
hinMod1 <- glm(hin ~ pop + PCT_wht + PCT_blk + PCT_car + PCT_trn + PCT_bik + PCT_wfh + PCT_chld + PCT_own + m311,
data=dat %>% st_drop_geometry(),
family="binomial" (link="logit"))
summary(hinMod1)
data.frame(100*(exp(coef(hinMod1)))-1) %>%
kable()
hinMod1 <- glm(hin ~ pop + mdn_inc + PCT_wht + PCT_blk + PCT_car + PCT_trn + PCT_bik + PCT_wfh + PCT_chld + PCT_own + m311,
data=dat %>% st_drop_geometry(),
family="binomial" (link="logit"))
summary(hinMod1)
hinMod1 <- glm(hin ~ pop + med_rent + PCT_wht + PCT_blk + PCT_car + PCT_trn + PCT_bik + PCT_wfh + PCT_chld + PCT_own + m311,
data=dat %>% st_drop_geometry(),
family="binomial" (link="logit"))
summary(hinMod1)
data.frame(100*(exp(coef(hinMod1)))-1) %>%
kable()
summary(hinMod1)
dat <- dat %>%
mutate(dom_wht = if_else(PCT_wht > 0.50, 1, 0),
hm311 = as.numeric(if_else(m311 > 3, 1, 0)),
logm311 = log(m311),
PCT_chld = Under_18/pop)
View(dat)
dat <- dat %>%
mutate(dom_wht = if_else(PCT_wht > 0.50, 1, 0),
dom_blk = if_else(PCT_blk > 0.50, 1, 0),
hm311 = as.numeric(if_else(m311 > 3, 1, 0)),
logm311 = log(m311),
PCT_chld = Under_18/pop)
hinMod1 <- glm(hin ~ pop + med_rent + dom_wht + dom_blk + PCT_car + PCT_trn + PCT_bik + PCT_wfh + PCT_chld + PCT_own + m311,
data=dat %>% st_drop_geometry(),
family="binomial" (link="logit"))
summary(hinMod1)
data.frame(100*(exp(coef(hinMod1)))-1) %>%
kable()
hinMod1 <- glm(hin ~ pop + med_rent + PCT_wht + PCT_blk + PCT_car + PCT_trn + PCT_bik + PCT_wfh + PCT_chld + PCT_own + m311,
data=dat %>% st_drop_geometry(),
family="binomial" (link="logit"))
data.frame(100*(exp(coef(hinMod1)))-1) %>%
kable()
hinMod1 <- glm(hin ~ pop + med_rent + dom_wht + dom_blk + PCT_car + PCT_trn + PCT_bik + PCT_wfh + PCT_chld + PCT_own + m311,
data=dat %>% st_drop_geometry(),
family="binomial" (link="logit"))
data.frame(100*(exp(coef(hinMod1)))-1) %>%
kable()
hinMod1 <- glm(hin ~ pop + med_rent + dom_wht + PCT_car + PCT_trn + PCT_bik + PCT_wfh + PCT_chld + PCT_own + m311,
hinMod1 <- glm(hin ~ pop + med_rent + dom_wht + PCT_car + PCT_trn + PCT_bik + PCT_wfh + PCT_chld + PCT_own + m311,
data=dat %>% st_drop_geometry(),
family="binomial" (link="logit"))
data=dat %>% st_drop_geometry(),
family="binomial" (link="logit"))
hinMod1 <- glm(hin ~ pop + med_rent + dom_wht + PCT_car + PCT_trn + PCT_bik + PCT_wfh + PCT_chld + PCT_own + m311,
data=dat %>% st_drop_geometry(),
family="binomial" (link="logit"))
data.frame(100*(exp(coef(hinMod1)))-1) %>%
kable()
hinMod1 <- glm(hin ~ pop + med_rent +  dom_blk + PCT_car + PCT_trn + PCT_bik + PCT_wfh + PCT_chld + PCT_own + m311,
data=dat %>% st_drop_geometry(),
family="binomial" (link="logit"))
data.frame(100*(exp(coef(hinMod1)))-1) %>%
kable()
hinMod1 <- glm(hin ~ pop + med_rent + dom_wht+ dom_blk + PCT_car + PCT_trn + PCT_bik + PCT_wfh + PCT_chld + PCT_own + m311,
data=dat %>% st_drop_geometry(),
family="binomial" (link="logit"))
data.frame(100*(exp(coef(hinMod1)))-1) %>%
kable()
hinMod1 <- glm(hin ~ pop + med_rent +  dom_blk + PCT_car + PCT_trn + PCT_bik + PCT_wfh + PCT_chld + PCT_own + m311,
data=dat %>% st_drop_geometry(),
family="binomial" (link="logit"))
summary(hinMod1)
hinMod1 <- glm(hin ~ pop + med_rent +  dom_blk + PCT_car + PCT_trn + PCT_bik + PCT_wfh + PCT_own + m311,
data=dat %>% st_drop_geometry(),
family="binomial" (link="logit"))
summary(hinMod1)
data.frame(100*(exp(coef(hinMod1)))-1) %>%
kable()
hinMod1 <- glm(hin ~ pop + dom_wht + dom_blk + PCT_car + PCT_trn + PCT_bik + PCT_wfh + PCT_own + m311,
data=dat %>% st_drop_geometry(),
family="binomial" (link="logit"))
summary(hinMod1)
hinMod1 <- glm(hin ~ pop + med_rent + dom_wht + PCT_blk + PCT_car + PCT_trn + PCT_bik + PCT_chld + PCT_own + m311,
data=dat %>% st_drop_geometry(),
family="binomial" (link="logit"))
summary(hinMod1)
summary(hinMod1)
data.frame(100*(exp(coef(hinMod1)))-1) %>%
kable()
hinMod1 <- glm(hin ~ pop + med_rent + dom_wht + PCT_blk + PCT_car + PCT_trn + PCT_bik + PCT_chld + PCT_own + m311,
data=dat %>% st_drop_geometry(),
family="binomial" (link="logit"))
summary(hinMod1)
hinMod1 <- glm(hin ~ med_rent + dom_wht + PCT_blk + PCT_car + PCT_trn + PCT_bik + PCT_chld + PCT_own + m311,
data=dat %>% st_drop_geometry(),
family="binomial" (link="logit"))
summary(hinMod1)
data.frame(100*(exp(coef(hinMod1)))-1) %>%
kable()
hinMod1 <- glm(hin ~ med_rent + dom_wht + dom_blk + PCT_car + PCT_trn + PCT_bik + PCT_chld + PCT_own + m311,
data=dat %>% st_drop_geometry(),
family="binomial" (link="logit"))
summary(hinMod1)
data.frame(100*(exp(coef(hinMod1)))-1) %>%
kable()
cor.test(dat$dom_wht,dat$dom_blk)
hinMod1 <- glm(hin ~ med_rent + dom_blk + PCT_car + PCT_trn + PCT_bik + PCT_chld + PCT_own + m311,
data=dat %>% st_drop_geometry(),
family="binomial" (link="logit"))
summary(hinMod1)
hinMod1 <- glm(hin ~ med_rent + dom_blk + PCT_car + PCT_trn + PCT_bik + PCT_own + m311,
data=dat %>% st_drop_geometry(),
family="binomial" (link="logit"))
summary(hinMod1)
data.frame(100*(exp(coef(hinMod1)))-1) %>%
kable()
hinMod1 <- glm(hin ~ med_rent + dom_blk + PCT_car + PCT_bik + PCT_own + m311,
data=dat %>% st_drop_geometry(),
family="binomial" (link="logit"))
summary(hinMod1)
data.frame(100*(exp(coef(hinMod1)))-1) %>%
kable()
cor.test(dat$PCT_car, dat$PCT_trn)
cor.test(dat$PCT_bik, dat$PCT_wlk)
dat <- dat %>%
mutate(maj_wht = if_else(PCT_wht > 0.50, 1, 0),
maj_blk = if_else(PCT_blk > 0.50, 1, 0),
lm311 = as.numeric(if_else(m311 < 4, 1, 0)),
logm311 = log(m311),
PCT_chld = Under_18/pop)
#backward stepwise regression
hin_test <- glm(hin ~ pop + mdn_inc + med_rent + workers + PCT_f + PCT_wht + PCT_blk + PCT_asn + PCT_na + PCT_pi + PCT_oth + PCT_mlt + PCT_hsp + PCT_car + PCT_trn + PCT_bik + PCT_wlk + PCT_wfh + PCT_own + PCT_pov + PCT_chld + all311 + m311,
data = dat %>% st_drop_geometry(),
family="binomial" (link="logit"))
step(hin_test, direction="backward")
lm311_test <- glm(lm311 ~ pop + mdn_inc + med_rent + workers + PCT_f + PCT_wht + PCT_blk + PCT_asn + PCT_na + PCT_pi + PCT_oth + PCT_mlt + PCT_hsp + PCT_car + PCT_trn + PCT_bik + PCT_wlk + PCT_wfh + PCT_own + PCT_pov + PCT_chld + all311 + m311,
data = dat %>% st_drop_geometry(),
family="binomial" (link="logit"))
lm311_test <- glm(lm311 ~ pop + mdn_inc + med_rent + workers + PCT_f + PCT_wht + PCT_blk + PCT_asn + PCT_na + PCT_pi + PCT_oth + PCT_mlt + PCT_hsp + PCT_car + PCT_trn + PCT_bik + PCT_wlk + PCT_wfh + PCT_own + PCT_pov + PCT_chld,
data = dat %>% st_drop_geometry(),
family="binomial" (link="logit"))
step(lm311_test, direction="backward")
l311Mod2 <- glm(formula = lm311 ~ mdn_inc + med_rent + workers + PCT_f +
PCT_blk + PCT_hsp + PCT_trn + PCT_bik + PCT_wlk + PCT_wfh +
PCT_own + PCT_pov + PCT_chld, family = binomial(link = "logit"),
data = dat %>% st_drop_geometry())
data.frame(100*(exp(coef(l311Mod2)))-1) %>%
kable()
data.frame(100*(exp(coef(l311Mod2)))-1) %>%
kable() %>%
kable_styling()
data.frame(100*(exp(coef(l311Mod2)))-1) %>%
kable()
summary(hinMod1)
l311Mod2 <- glm(formula = lm311 ~ mdn_inc + med_rent + workers + PCT_f +
PCT_blk + PCT_hsp + PCT_trn + PCT_bik + PCT_wlk + PCT_wfh +
PCT_own + PCT_pov + PCT_chld, family = binomial(link = "logit"),
data = dat %>% st_drop_geometry())
summary(l311Mod2)
#backward stepwise regression
hin_test <- glm(hin ~ pop + mdn_inc + med_rent + workers + PCT_f + PCT_wht + maj_wht + PCT_blk + maj_blk + PCT_asn + PCT_na + PCT_pi + PCT_oth + PCT_mlt + PCT_hsp + PCT_car + PCT_trn + PCT_bik + PCT_wlk + PCT_wfh + PCT_own + PCT_pov + PCT_chld + all311 + m311,
data = dat %>% st_drop_geometry(),
family="binomial" (link="logit"))
lm311_test <- glm(lm311 ~ pop + mdn_inc + med_rent + workers + PCT_f + PCT_wht + maj_wht + PCT_blk + maj_blk + PCT_asn + PCT_na + PCT_pi + PCT_oth + PCT_mlt + PCT_hsp + PCT_car + PCT_trn + PCT_bik + PCT_wlk + PCT_wfh + PCT_own + PCT_pov + PCT_chld,
data = dat %>% st_drop_geometry(),
family="binomial" (link="logit"))
step(lm311_test, direction="backward")
l311Mod2 <- glm(formula = lm311 ~ mdn_inc + med_rent + workers + PCT_f +
PCT_blk + maj_blk + PCT_hsp + PCT_trn + PCT_bik + PCT_wlk +
PCT_wfh + PCT_own + PCT_pov + PCT_chld, family = binomial(link = "logit"),
data = dat %>% st_drop_geometry())
summary(l311Mod2)
data.frame(100*(exp(coef(l311Mod2)))-1) %>%
kable()
l311Mod1 <- glm(lm311 ~ med_rent + maj_blk + PCT_car + PCT_bik + PCT_own + m311,
data=dat %>% st_drop_geometry(),
family="binomial" (link="logit"))
l311Mod1 <- glm(lm311 ~ med_rent + maj_blk + PCT_car + PCT_bik + PCT_own,
data=dat %>% st_drop_geometry(),
family="binomial" (link="logit"))
l311Mod1 <- glm(lm311 ~ med_rent + maj_blk + PCT_car + PCT_bik + PCT_own,
data=dat %>% st_drop_geometry(),
family="binomial" (link="logit"))
summary(l311Mod1)
data.frame(100*(exp(coef(l311Mod1)))-1) %>%
kable()
summary(l311Mod1)
#our honed model
hinMod1 <- glm(hin ~ med_rent + maj_blk + PCT_car + PCT_bik + PCT_own + PCT_pov + m311,
data=dat %>% st_drop_geometry(),
family="binomial" (link="logit"))
summary(hinMod1)
#our honed model
hinMod1 <- glm(hin ~ med_rent + maj_blk + PCT_car + PCT_bik + PCT_own + m311,
data=dat %>% st_drop_geometry(),
family="binomial" (link="logit"))
l311Mod1 <- glm(lm311 ~ med_rent + maj_blk + PCT_car + PCT_bik + PCT_own + PCT_pov,
data=dat %>% st_drop_geometry(),
family="binomial" (link="logit"))
summary(l311Mod1)
cor.test(dat$PCT_own,dat$PCT_pov)
cor.test(dat$mdn_inc,dat$PCT_own)
l311Mod1 <- glm(lm311 ~ med_rent + maj_blk + PCT_car + PCT_bik + PCT_own + PCT_pov,
data=dat %>% st_drop_geometry(),
family="binomial" (link="logit"))
cor.test(dat$med_rent, dat$PCT_pov)
summary(l311Mod1)
data.frame(100*(exp(coef(l311Mod1)))-1) %>%
kable()
data.frame(100*(exp(coef(hinMod1)))-1) %>%
kable()
l311Mod1 <- glm(lm311 ~ med_rent + maj_blk + PCT_car + PCT_bik + PCT_own + PCT_pov,
data=dat %>% st_drop_geometry(),
family="binomial" (link="logit"))
data.frame(100*(exp(coef(l311Mod1)))-1) %>%
kable()
dat1 <- filter(dat, m311>3 & HIN==1)
dat1 <- filter(dat, m311>3 & hin==1)
dat2 <- filter(dat, m311<=3 & hin==1)
dat3 <- filter(dat, m311>3 & hin==0)
dat1 %>% summarise_if(is.numeric, mean, na.rm = TRUE)
library(dplyr)
dat1 %>% summarise_if(is.numeric, mean, na.rm = TRUE)
dat1 %>% summarise(across(where(is.numeric), ~ mean(.x, na.rm = TRUE)))
dat2 %>% summarise(across(where(is.numeric), ~ mean(.x, na.rm = TRUE)))
dat3 %>% summarise(across(where(is.numeric), ~ mean(.x, na.rm = TRUE)))
dat <- dat %>%
mutate(PCT_chld = Under_18/pop,
maj_wht = if_else(PCT_wht > 0.50, 1, 0),
maj_blk = if_else(PCT_blk > 0.50, 1, 0),
lm311 = if_else(m311 < 4, 1, 0),
logm311 = log(m311),
gap311 = if_else(m311<4 & hin==1, 1,0)
)
dat <- dat %>%
mutate(PCT_chld = Under_18/pop,
maj_wht = if_else(PCT_wht > 0.50, 1, 0),
maj_blk = if_else(PCT_blk > 0.50, 1, 0),
lm311 = if_else(m311 < 4, 1, 0),
logm311 = log(m311),
gap = if_else(m311<4 & hin==1, 1,0)
)
View(dat)
HIN_dat <- filter(dat, hin == 1)
mcase_dat <- filter(dat, m311_cn > 3)
mcase_dat <- filter(dat, m311 > 3)
HIN_d <- density(HIN_dat$pct_own)
HIN_d <- density(HIN_dat$pct_own)
HIN_dat <- filter(dat, hin == 1)
mcase_dat <- filter(dat, m311 > 3)
HIN_d <- density(HIN_dat$pct_own)
HIN_d <- density(HIN_dat$PCT_own)
plot(HIN_d)
HIN_dat <- filter(dat, hin == 1)
mcase_dat <- filter(dat, m311 > 3)
HIN_d <- density(HIN_dat$PCT_own)
mcase_d <- density(mcase_dat$PCT_own)
acs_d <- density(acs$pct_own, na.rm=TRUE)
HIN_dat <- filter(dat, hin == 1)
mcase_dat <- filter(dat, m311 > 3)
HIN_d <- density(HIN_dat$PCT_own)
mcase_d <- density(mcase_dat$PCT_own)
acs_d <- density(acs$PCT_own, na.rm=TRUE)
acs_d <- density(dat$PCT_own, na.rm=TRUE)
gap_d <- density(gap_dat$PCT_own, na.rm=TRUE)
plot(HIN_d, ylim=c(0,7))
plot(HIN_d, ylim=c(0,7))
plot(mcase_d, ylim=c(0,7))
plot(acs_d, ylim=c(0,7))
step(gap_test, direction="backward")
gap_test <- glm(gap ~ pop + mdn_inc + med_rent + workers + PCT_f + PCT_wht + maj_wht + PCT_blk + maj_blk + PCT_asn + PCT_na + PCT_pi + PCT_oth + PCT_mlt + PCT_hsp + PCT_car + PCT_trn + PCT_bik + PCT_wlk + PCT_wfh + PCT_own + PCT_pov + PCT_chld + all311 + m311,
data = dat %>% st_drop_geometry(),
family="binomial" (link="logit"))
step(gap_test, direction="backward")
get_acs_csv <- function(yr1, variableList, nameList) {
acs1 <- get_acs(geography = "county",
year = yr1,
variables = variableList,
geometry = TRUE,
state  = "PA",
county = "Philadelphia",
output = "wide"
)
acs_full <- acs1 %>% dplyr:: select(!ends_with("M")) #include this line to remove margins of error
names(acs_full) <- c("GEOID","NAME", nameList,"geometry")
#acs_full <- acs_full[order(acs_full$GEOID),]
#write.csv(acs_full, file=paste(deparse(substitute(variableList)), yr1,"-",yr2, ".csv")) #include this line to export a csv
return(acs_full)
}
acs_philly <- get_acs_csv(2019,variableList, nameList)
variableList <- c("B01001_001", #total population
"B01001_002", #total male
"B01001_026", #total female
"B02001_002", #white alone
"B02001_003", #black alone
"B02001_004", #AmIn/AlNative alone
"B02001_005", #Asian alone
"B02001_006", #Native hawaiian/PI alone
"B02001_007", #some other race alone
"B02001_008", #two plus races
"B03003_003", #total Hispanic or Latino
"B05009_001", #under 18 years B05009_001 for 2010, B09001_001 for 2019
"B15001_001", #18 years + B15001_001 for 2010, B09021_001 for 2019
"B11003_001", #families with children under 18
"B08301_001", #workers
"B08301_002", #means of transportation to work: car
"B08301_010", #means of transportation to work: public transit
"B08301_018", #means of transportation to work: bicycle
"B08301_019", #means of transportation to work: walked
"B08301_021", #means of transportation to work: wfh
"B19013_001", #median income
"B17001_002", #Income in the past 12 months below poverty level
"B17001_031", #Income in the past 12 months at or above poverty level
"B25064_001", #median gross rent
"B25003_002", #owner occupied
"B25003_003" #renter occupied
)
nameList <- c("pop",
"male",
"fem",
"white",
"black",
"native_am",
"asian",
"nh_pi",
"other",
"multi",
"hisp_lat",
"Under_18",
"Above_18",
"fam_child",
"workers",
"Car",
"Transit",
"Bicycle",
"Walking",
"WFH",
"mdn_inc",
"blw_pov",
"abv_pov",
"med_rent",
"own",
"rent")
acs_philly <- get_acs_csv(2019,variableList, nameList)
View(acs_philly)
# add percentages
acs_philly <- acs_philly %>%
mutate(PCT_m = male/pop,
PCT_f = fem/pop,
PCT_wht = white/pop,
PCT_blk = black/pop,
PCT_na = native_am/pop,
PCT_asn = asian/pop,
PCT_pi = nh_pi/pop,
PCT_oth = other/pop,
PCT_mlt = multi/pop,
PCT_hsp = hisp_lat/pop,
PCT_chld = Under_18/pop,
PCT_car = Car/workers,
PCT_trn = Transit/workers,
PCT_bik = Bicycle/workers,
PCT_wlk = Walking/workers,
PCT_wfh = WFH/workers,
PCT_pov = blw_pov/pop,
PCT_own = own/pop,
PCT_rent = rent/pop,
maj_wht = if_else(PCT_wht > 0.50, 1, 0),
maj_blk = if_else(PCT_blk > 0.50, 1, 0))
View(acs_philly)
gapMod1 <- glm(gap ~ med_rent + maj_blk + PCT_car + PCT_bik + PCT_own + PCT_pov,
data=dat %>% st_drop_geometry(),
family="binomial" (link="logit"))
summary()
summary(gapMod1)
gapMod1 <- glm(gap ~ med_rent + maj_blk + PCT_car + PCT_bik + PCT_own ,
data=dat %>% st_drop_geometry(),
family="binomial" (link="logit"))
summary(gapMod1)
gapMod2 <- glm(formula = gap ~ mdn_inc + med_rent + PCT_blk + maj_blk +
PCT_asn + PCT_oth + PCT_hsp + PCT_car + PCT_bik + PCT_wlk +
PCT_wfh + PCT_own + PCT_pov + PCT_chld + all311 + m311, family = binomial(link = "logit"),
data = dat %>% st_drop_geometry())
summary(gapMod12)
summary(gapMod2)
data.frame(100*(exp(coef(gapMod1)))-1) %>%
kable()
gapMod1 <- glm(gap ~ med_rent + PCT_blk + PCT_car + PCT_bik + PCT_own + PCT_pov,
data=dat %>% st_drop_geometry(),
family="binomial" (link="logit"))
summary(gapMod1)
gapMod1 <- glm(gap ~ med_rent + maj_blk + PCT_bik + PCT_own + PCT_pov,
data=dat %>% st_drop_geometry(),
family="binomial" (link="logit"))
summary(gapMod1)
gapMod1 <- glm(gap ~ med_rent + maj_blk + PCT_trn + PCT_bik + PCT_own + PCT_pov,
data=dat %>% st_drop_geometry(),
family="binomial" (link="logit"))
summary(gapMod1)
gapMod1 <- glm(gap ~ med_rent + maj_blk + PCT_wlk + PCT_bik + PCT_own + PCT_pov,
data=dat %>% st_drop_geometry(),
family="binomial" (link="logit"))
summary(gapMod1)
gapMod1 <- glm(gap ~ maj_blk + PCT_car + PCT_bik + PCT_own + PCT_pov,
data=dat %>% st_drop_geometry(),
family="binomial" (link="logit"))
summary(gapMod1)
gapMod1 <- glm(gap ~ med_rent + maj_blk + PCT_car + PCT_bik + PCT_own + PCT_pov,
data=dat %>% st_drop_geometry(),
family="binomial" (link="logit"))
summary(gapMod1)
gapMod1 <- glm(gap ~ mdn_inc + maj_blk + PCT_car + PCT_bik + PCT_own + PCT_pov,
data=dat %>% st_drop_geometry(),
family="binomial" (link="logit"))
summary(gapMod1)
gapMod1 <- glm(gap ~ med_rent + maj_blk + PCT_car + PCT_bik + PCT_own + PCT_pov,
data=dat %>% st_drop_geometry(),
family="binomial" (link="logit"))
summary(gapMod1)
data.frame(100*(exp(coef(gapMod1)))-1) %>%
kable()
data=dat %>% st_drop_geometry() %>% filter(gap==1)
View(data)
data=dat %>% st_drop_geometry() %>% filter(hin==1)
gapMod1 <- glm(lm311 ~ med_rent + maj_blk + PCT_car + PCT_bik + PCT_own + PCT_pov,
data=dat %>% st_drop_geometry() %>% filter(hin==1),
family="binomial" (link="logit"))
summary(gapMod1)
gap_test <- glm(lm311 ~ pop + mdn_inc + med_rent + workers + PCT_f + PCT_wht + maj_wht + PCT_blk + maj_blk + PCT_asn + PCT_na + PCT_pi + PCT_oth + PCT_mlt + PCT_hsp + PCT_car + PCT_trn + PCT_bik + PCT_wlk + PCT_wfh + PCT_own + PCT_pov + PCT_chld + all311 + m311,
data = dat %>% st_drop_geometry() %>% filter(hin==1),
family="binomial" (link="logit"))
gap_test <- glm(lm311 ~ pop + mdn_inc + med_rent + workers + PCT_f + PCT_wht + maj_wht + PCT_blk + maj_blk + PCT_asn + PCT_na + PCT_pi + PCT_oth + PCT_mlt + PCT_hsp + PCT_car + PCT_trn + PCT_bik + PCT_wlk + PCT_wfh + PCT_own + PCT_pov + PCT_chld,
data = dat %>% st_drop_geometry() %>% filter(hin==1),
family="binomial" (link="logit"))
step(gap_test, direction="backward")
View(data)
gapMod2 <- glm(formula = lm311 ~ pop + mdn_inc + med_rent + PCT_blk + maj_blk + PCT_na +
PCT_pi + PCT_oth + PCT_hsp + PCT_car + PCT_bik + PCT_own +
PCT_pov + PCT_chld, family = binomial(link = "logit"),
data = dat %>% st_drop_geometry() %>% filter(hin==1))
summary(gapMod2)
cor.test(data$med_rent,data$mdn_inc)
gapMod1 <- glm(lm311 ~ med_rent + maj_blk + PCT_bik + PCT_own,
data=dat %>% st_drop_geometry() %>% filter(hin==1),
family="binomial" (link="logit"))
summary(gapMod2)
summary(gapMod1)
cor.test(data$med_rent,data$PCT_pov)
gapMod1 <- glm(lm311 ~ med_rent + maj_blk + PCT_bik + PCT_own + PCT_pov,
data=dat %>% st_drop_geometry() %>% filter(hin==1),
family="binomial" (link="logit"))
summary(gapMod1)
gapMod1 <- glm(lm311 ~ maj_blk + PCT_bik + PCT_own,
data=dat %>% st_drop_geometry() %>% filter(hin==1),
family="binomial" (link="logit"))
summary(gapMod1)
data.frame(100*(exp(coef(gapMod1)))-1) %>%
kable()
